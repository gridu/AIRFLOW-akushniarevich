[2020-01-08 19:07:37,069] {taskinstance.py:630} INFO - Dependencies all met for <TaskInstance: dag_id_0.check_table_exist 2020-01-08T19:00:42.082277+00:00 [queued]>
[2020-01-08 19:07:37,201] {taskinstance.py:630} INFO - Dependencies all met for <TaskInstance: dag_id_0.check_table_exist 2020-01-08T19:00:42.082277+00:00 [queued]>
[2020-01-08 19:07:37,202] {taskinstance.py:841} INFO - 
--------------------------------------------------------------------------------
[2020-01-08 19:07:37,203] {taskinstance.py:842} INFO - Starting attempt 3 of 3
[2020-01-08 19:07:37,203] {taskinstance.py:843} INFO - 
--------------------------------------------------------------------------------
[2020-01-08 19:07:37,224] {taskinstance.py:862} INFO - Executing <Task(BranchPythonOperator): check_table_exist> on 2020-01-08T19:00:42.082277+00:00
[2020-01-08 19:07:37,225] {base_task_runner.py:133} INFO - Running: ['airflow', 'run', 'dag_id_0', 'check_table_exist', '2020-01-08T19:00:42.082277+00:00', '--job_id', '90', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/jobs_dag.py', '--cfg_path', '/tmp/tmpodrcn4el']
[2020-01-08 19:07:37,854] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist /usr/local/lib/python3.7/site-packages/airflow/configuration.py:226: FutureWarning: The task_runner setting in [core] has the old default value of 'BashTaskRunner'. This value has been changed to 'StandardTaskRunner' in the running config, but please update your config before Apache Airflow 2.0.
[2020-01-08 19:07:37,855] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   FutureWarning
[2020-01-08 19:07:37,855] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist /usr/local/lib/python3.7/site-packages/airflow/config_templates/airflow_local_settings.py:65: DeprecationWarning: The elasticsearch_host option in [elasticsearch] has been renamed to host - the old setting has been used, but please update your config.
[2020-01-08 19:07:37,856] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   ELASTICSEARCH_HOST = conf.get('elasticsearch', 'HOST')
[2020-01-08 19:07:37,856] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist /usr/local/lib/python3.7/site-packages/airflow/config_templates/airflow_local_settings.py:67: DeprecationWarning: The elasticsearch_log_id_template option in [elasticsearch] has been renamed to log_id_template - the old setting has been used, but please update your config.
[2020-01-08 19:07:37,857] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   ELASTICSEARCH_LOG_ID_TEMPLATE = conf.get('elasticsearch', 'LOG_ID_TEMPLATE')
[2020-01-08 19:07:37,857] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist /usr/local/lib/python3.7/site-packages/airflow/config_templates/airflow_local_settings.py:69: DeprecationWarning: The elasticsearch_end_of_log_mark option in [elasticsearch] has been renamed to end_of_log_mark - the old setting has been used, but please update your config.
[2020-01-08 19:07:37,857] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   ELASTICSEARCH_END_OF_LOG_MARK = conf.get('elasticsearch', 'END_OF_LOG_MARK')
[2020-01-08 19:07:37,960] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist [2020-01-08 19:07:37,959] {settings.py:252} INFO - settings.configure_orm(): Using pool settings. pool_size=5, max_overflow=10, pool_recycle=1800, pid=1698
[2020-01-08 19:07:38,964] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist [2020-01-08 19:07:38,963] {__init__.py:51} INFO - Using executor CeleryExecutor
[2020-01-08 19:07:38,965] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist [2020-01-08 19:07:38,964] {dagbag.py:92} INFO - Filling up the DagBag from /usr/local/airflow/dags/jobs_dag.py
[2020-01-08 19:07:39,104] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist [2020-01-08 19:07:39,103] {cli.py:545} INFO - Running <TaskInstance: dag_id_0.check_table_exist 2020-01-08T19:00:42.082277+00:00 [running]> on host 6667999380fe
[2020-01-08 19:07:39,208] {python_operator.py:105} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_ID=dag_id_0
AIRFLOW_CTX_TASK_ID=check_table_exist
AIRFLOW_CTX_EXECUTION_DATE=2020-01-08T19:00:42.082277+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2020-01-08T19:00:42.082277+00:00
[2020-01-08 19:07:39,250] {logging_mixin.py:112} INFO - [2020-01-08 19:07:39,250] {base_hook.py:84} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: airflow, Login: airflow, Password: XXXXXXXX, extra: {}
[2020-01-08 19:07:39,287] {logging_mixin.py:112} INFO - [2020-01-08 19:07:39,287] {jobs_dag.py:31} INFO - [('public', 'alembic_version', 'airflow', None, True, False, False, False), ('public', 'celery_taskmeta', 'airflow', None, True, False, False, False), ('public', 'celery_tasksetmeta', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_statistic', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_type', 'airflow', None, True, False, False, False), ('public', 'slot_pool', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_authid', 'airflow', 'pg_global', True, False, False, False), ('public', 'known_event_type', 'airflow', None, True, False, True, False), ('public', 'known_event', 'airflow', None, True, False, True, False), ('pg_catalog', 'pg_user_mapping', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_attribute', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_proc', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_class', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_attrdef', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_constraint', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_inherits', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_index', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_operator', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_opfamily', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_opclass', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_am', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_amop', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_amproc', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_language', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_largeobject_metadata', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_aggregate', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_rewrite', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_largeobject', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_trigger', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_event_trigger', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_description', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_cast', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_enum', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_namespace', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_conversion', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_depend', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_database', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_db_role_setting', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_tablespace', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_pltemplate', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_auth_members', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_shdepend', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_shdescription', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_ts_config', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_ts_config_map', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_ts_dict', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_ts_parser', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_ts_template', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_extension', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_foreign_data_wrapper', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_foreign_server', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_foreign_table', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_policy', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_replication_origin', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_default_acl', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_init_privs', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_seclabel', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_shseclabel', 'airflow', 'pg_global', True, False, False, False), ('pg_catalog', 'pg_collation', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_range', 'airflow', None, True, False, False, False), ('pg_catalog', 'pg_transform', 'airflow', None, True, False, False, False), ('information_schema', 'sql_features', 'airflow', None, False, False, False, False), ('information_schema', 'sql_implementation_info', 'airflow', None, False, False, False, False), ('information_schema', 'sql_languages', 'airflow', None, False, False, False, False), ('information_schema', 'sql_packages', 'airflow', None, False, False, False, False), ('information_schema', 'sql_parts', 'airflow', None, False, False, False, False), ('information_schema', 'sql_sizing', 'airflow', None, False, False, False, False), ('information_schema', 'sql_sizing_profiles', 'airflow', None, False, False, False, False), ('public', 'connection', 'airflow', None, True, False, False, False), ('public', 'variable', 'airflow', None, True, False, False, False), ('public', 'chart', 'airflow', None, True, False, True, False), ('public', 'dag_pickle', 'airflow', None, True, False, False, False), ('public', 'dag_run', 'airflow', None, True, False, False, False), ('public', 'import_error', 'airflow', None, True, False, False, False), ('public', 'job', 'airflow', None, True, False, False, False), ('public', 'log', 'airflow', None, True, False, False, False), ('public', 'sla_miss', 'airflow', None, True, False, False, False), ('public', 'task_fail', 'airflow', None, True, False, False, False), ('public', 'xcom', 'airflow', None, True, False, False, False), ('public', 'kube_resource_version', 'airflow', None, True, False, False, False), ('public', 'kube_worker_uuid', 'airflow', None, True, False, False, False), ('public', 'users', 'airflow', None, True, False, True, False), ('public', 'dag', 'airflow', None, True, False, False, False), ('public', 'task_instance', 'airflow', None, True, False, True, False), ('public', 'task_reschedule', 'airflow', None, True, False, True, False)]
[2020-01-08 19:07:39,288] {logging_mixin.py:112} INFO - [2020-01-08 19:07:39,288] {jobs_dag.py:35} INFO - public
[2020-01-08 19:07:39,321] {logging_mixin.py:112} INFO - [2020-01-08 19:07:39,321] {base_hook.py:84} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: airflow, Login: airflow, Password: XXXXXXXX, extra: {}
[2020-01-08 19:07:39,379] {logging_mixin.py:112} INFO - [2020-01-08 19:07:39,379] {jobs_dag.py:39} INFO - None
[2020-01-08 19:07:39,380] {taskinstance.py:1058} ERROR - 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 930, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 141, in execute
    branch = super(BranchPythonOperator, self).execute(context)
  File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 113, in execute
    return_value = self.execute_callable()
  File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 118, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/usr/local/airflow/dags/jobs_dag.py", line 41, in check_table_existance
    return 'skip_table_creation' if query[0] else 'create_table'
TypeError: 'NoneType' object is not subscriptable
[2020-01-08 19:07:39,386] {taskinstance.py:1089} INFO - Marking task as FAILED.
[2020-01-08 19:07:39,456] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist Traceback (most recent call last):
[2020-01-08 19:07:39,457] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/bin/airflow", line 37, in <module>
[2020-01-08 19:07:39,457] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     args.func(args)
[2020-01-08 19:07:39,457] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/utils/cli.py", line 74, in wrapper
[2020-01-08 19:07:39,458] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     return f(*args, **kwargs)
[2020-01-08 19:07:39,458] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/bin/cli.py", line 551, in run
[2020-01-08 19:07:39,459] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     _run(args, dag, ti)
[2020-01-08 19:07:39,460] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/bin/cli.py", line 469, in _run
[2020-01-08 19:07:39,460] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     pool=args.pool,
[2020-01-08 19:07:39,461] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/utils/db.py", line 74, in wrapper
[2020-01-08 19:07:39,461] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     return func(*args, **kwargs)
[2020-01-08 19:07:39,462] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 930, in _run_raw_task
[2020-01-08 19:07:39,462] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     result = task_copy.execute(context=context)
[2020-01-08 19:07:39,463] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 141, in execute
[2020-01-08 19:07:39,464] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     branch = super(BranchPythonOperator, self).execute(context)
[2020-01-08 19:07:39,464] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 113, in execute
[2020-01-08 19:07:39,464] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     return_value = self.execute_callable()
[2020-01-08 19:07:39,465] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 118, in execute_callable
[2020-01-08 19:07:39,465] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     return self.python_callable(*self.op_args, **self.op_kwargs)
[2020-01-08 19:07:39,465] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist   File "/usr/local/airflow/dags/jobs_dag.py", line 41, in check_table_existance
[2020-01-08 19:07:39,466] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist     return 'skip_table_creation' if query[0] else 'create_table'
[2020-01-08 19:07:39,466] {base_task_runner.py:115} INFO - Job 90: Subtask check_table_exist TypeError: 'NoneType' object is not subscriptable
[2020-01-08 19:07:42,001] {logging_mixin.py:112} INFO - [2020-01-08 19:07:42,001] {local_task_job.py:124} WARNING - Time since last heartbeat(0.04 s) < heartrate(5.0 s), sleeping for 4.962572 s
[2020-01-08 19:07:46,972] {logging_mixin.py:112} INFO - [2020-01-08 19:07:46,971] {local_task_job.py:103} INFO - Task exited with return code 1
